-----VYTVOŘENÍ TABULKY PRO CENY POHONNÝCH HMOT V EU -----

CREATE OR REPLACE TABLE EURO_PRICES AS
SELECT 
TO_DATE(WOTAX.DATE, 'DD/MM/YY')::DATE AS DATE, 
WOTAX.COUNTRY::VARCHAR(200) AS COUNTRY,
REPLACE (WOTAX.GASOLINE_1000L, ',', '')::FLOAT AS GASOLINE_WITHOUT_TAX,
REPLACE (WITHTAX.GASOLINE_1000L, ',', '')::FLOAT AS GASOLINE_WITH_TAX,
GASOLINE_WITH_TAX - GASOLINE_WITHOUT_TAX AS GASOLINE_TAX_DELTA,
ROUND (GASOLINE_TAX_DELTA/GASOLINE_WITH_TAX*100,2)AS GASOLINE_DELTA_PERCENT,
REPLACE (WOTAX.DIESEL_1000L, ',', '')::FLOAT AS DIESEL_WITHOUT_TAX,
REPLACE (WITHTAX.DIESEL_1000L, ',', '')::FLOAT AS DIESEL_WITH_TAX,
DIESEL_WITH_TAX - DIESEL_WITHOUT_TAX AS DIESEL_TAX_DELTA,
ROUND (DIESEL_TAX_DELTA/DIESEL_WITH_TAX*100,2) AS DIESEL_DELTA_PERCENT
FROM "KEBOOLA_3424"."WORKSPACE_409334099"."euro-oil-bulletin-price-wo-tax-consumer-prices-wo-taxes" AS WOTAX
LEFT JOIN "KEBOOLA_3424"."WORKSPACE_409334099"."euro-oil-bulletin-price-with-tax-list1" AS WITHTAX
ON WOTAX.DATE = WITHTAX.DATE AND WOTAX.COUNTRY = WITHTAX.COUNTRY
;
